<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Deepdive" />
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/stylesheets/application.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deepdive</title>
  </head>

  <body>
      <a href="https://github.com/dennybritz/deepdive" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

      <div id="header">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <a href="" class="deepdive-logo">DeepDive Logo comes here</a> 
            </div>
          </row>
        </div>
      </div>

      <section id="main">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <h2 id="writing_inference_rules">Writing Inference Rules</h2>

<p>Inference rules describe how to <a href="">factor graph</a> is constructed. Each rule, or <em>factor</em>, consists of three components:</p>

<ul>
<li>The <strong>input query</strong> joins together feature relations from your extractors. One factor will be created for each row in the query result.</li>

<li>The <strong>factor function</strong> defines the variables that will be connected to each factor, and how they are related to each other.</li>

<li>The <strong>factor weight</strong> describes how confident you are that your rule is correct, in other words, how much weight you want to put on it during probabilistic inference. Weights can be constants, or automatically learned based on training data.</li>
</ul>

<h3 id="factor_input_query">Factor Input Query</h3>

<p>The input query of a factor combines all variables that a factor is using. It usually takes the form of a join query using feature relations produced extractors. The input query result must contain all variable attributes that are used in the factor functions.</p>

<pre><code>someFactor.input_query: &quot;SELECT people.*, friends.* FROM people INNER JOIN friends ON people.id = friends.person_id&quot;</code></pre>

<h3 id="factor_function">Factor Function</h3>

<p>The factor function defines the variables that will be connected to the factor, and how they are related to each other. All variables used in a factor function must have been previously <a href="schema.html">defined in the schema</a>.</p>

<p>Currently, DeepDive only supports one type of factor function: <code>Imply(...)</code>. The <code>Imply</code> function expresses a first-order logic statement. For example, <code>A = Imply(B, C)</code> means that, if B and C are true, then A is true.</p>

<pre><code># If people.smokes is true, then people.has_cancer is true
someFactor.function: &quot;people.has_cancer = Imply(people.smokes)&quot;

# people.has_cancer is always true
someFactor.function: &quot;people.has_cancer = Imply()&quot;

# Variable negation is possible: If people.smokes is false, then people.has_cancer is true
someFactor.function: &quot;people.has_cancer = Imply(!people.smokes)&quot; </code></pre>

<h3 id="factor_weights">Factor Weights</h3>

<p>Each factor is assigned a <em>weight</em>, which expresses how confident you are in its rule. During probabilistic inference, factors with a large weights will have a greater impact on variables than factors with small weights. Factor weights can be any real number, and are relative to each other. You can assign factor weights manually, or you can let DeepDive learn weights automatically. In order to learn weights automatically, you must have enough <a href="schema.html">training data</a> available. A weight can also be a function of variables, in which case each factor instance will get a different weight depending on the variable value.</p>

<pre><code># Known weight
wordsExtractor.factor.weight: 100

# Learn the weight, not depending on any variales. All factors created by this rule will have the same weight.
wordsExtractor.factor.weight: ?

# Learn the weight. Each factor will get a different weight depending on the value of people.gender
wordsExtractor.factor.weight: ?(people.gender)</code></pre>

<h3 id="full_example">Full Example</h3>

<pre><code>deepdive.factors: {
  smokesFactor.input_query: &quot;SELECT people.* FROM people&quot;
  smokesFactor.function: &quot;people.has_cancer = Imply(people.smokes)&quot;
  smokesFactor.weight: &quot;?(people.gender)&quot;

  # More factors...
}</code></pre>
            </div>
          </row>
        </div>
      </section>
    
      <footer id="footer">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <!-- <p class="copyright">Deepdive maintained by <a href="https://github.com/dennybritz">dennybritz</a></p> -->
            </div>
          </row>
        </div>
      </footer>

    
  
  </body>
</html>